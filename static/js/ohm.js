var language=2;let buttonFull;var imgTank=[];var imgVolt=[];var imgGlow;var voltage0=3;var resist0=3;var voltage=3;var resist=3;var time=0;var dropMax=200;var dropX=[];var dropY=[];var dropVX=[];var dropVY=[];function preload(){var url=getURL();var regexp="http";var m=match(url,regexp);var imagePrefix=(m=="http")?"image/":"";imgTank[0]=loadImage(imagePrefix+"ohms_law_r_1.png");imgTank[1]=loadImage(imagePrefix+"ohms_law_r_1.png");imgTank[2]=loadImage(imagePrefix+"ohms_law_r_2.png");imgTank[3]=loadImage(imagePrefix+"ohms_law_r_3.png");imgTank[4]=loadImage(imagePrefix+"ohms_law_r_4.png");imgTank[5]=loadImage(imagePrefix+"ohms_law_r_5.png");imgVolt[0]=loadImage(imagePrefix+"ohms_law_v_1.png");imgVolt[1]=loadImage(imagePrefix+"ohms_law_v_1.png");imgVolt[2]=loadImage(imagePrefix+"ohms_law_v_2.png");imgVolt[3]=loadImage(imagePrefix+"ohms_law_v_3.png");imgVolt[4]=loadImage(imagePrefix+"ohms_law_v_4.png");imgVolt[5]=loadImage(imagePrefix+"ohms_law_v_5.png");imgGlow=loadImage(imagePrefix+"bimetal_glow.png")}function setup(){frameRate(50);pixelDensity(2*displayDensity());var o=select("#myContainer");var a=0.5;var w=int((o.width>(window.innerHeight-120)/a)?(window.innerHeight-120)/a:o.width);var h=int(w*a);myCanvas=createCanvas(w,h);myCanvas.parent("myContainer");myCanvas.id("myP5Canvas");buttonFull=select("#buttonFull");buttonFull.mouseClicked(doFullScreen);if(language==0)buttonFull.html("전체화면");if(language==1)buttonFull.html("全画面表示");if(language==2)buttonFull.html("Fullscreen");for(var i=0;i<dropMax;i++)dropY[i]=1}function windowResized(){var o=select("#myContainer");var a=0.5;var w=int((o.width>(window.innerHeight-120)/a)?(window.innerHeight-120)/a:o.width);var h=int(w*a);resizeCanvas(w,h)}function draw(){if(touches.length>1)return;background(240);strokeWeight(1);time+=voltage/round(resist);if(time>=5){time-=5;for(var i=0;i<dropMax;i++){if(dropY[i]>0.6){dropX[i]=0.37;dropY[i]=0.4375;dropVX[i]=voltage*0.0015/round(resist);dropVY[i]=0;break}}}for(var i=0;i<dropMax;i++){if(dropY[i]<0.6){dropVY[i]+=0.00004;dropX[i]+=dropVX[i];dropY[i]+=dropVY[i]}}noStroke();fill(102,255,255);for(var i=0;i<dropMax;i+=3){ellipse(width*dropX[i],width*dropY[i],width*0.03,width*0.03)}imageMode(CORNER);noStroke();fill(102,255,255);rect(0,width*0.437,width*0.156,-width*voltage/12.34);image(imgTank[round(resist)],0,0,width,width*0.5);imageMode(CORNER);image(imgVolt[round(voltage)],0,0,width,width*0.5);imageMode(CENTER);tint(255,map(voltage/round(resist),0,5,0,255));image(imgGlow,width*0.922,width*0.439,width*0.19,width*0.19);noTint();noStroke();fill(255,0,0);if(dragged==0){drawArrow2D(width*0.21,width*(0.437-voltage/12.34),-width*0.04,0)}if(dragged==1){drawArrow2D(width*map(resist,1,5,0.212,0.312),width*0.37,0,width*0.04)}drawButtonDrag()}var x,y;var dragged=-1;var offsetX;var offsetY;function touchStarted(){if(!contain(mouseX,mouseY,0,0,width,height))return;if(touches.length>1)return;dragged=(dist(mouseX,mouseY,width*0.07,width*(0.437-voltage/12.34))<dist(mouseX,mouseY,width*0.25,width*0.44))?0:1;offsetX=mouseX;offsetY=mouseY;voltage0=voltage;resist0=resist}function touchMoved(){if(touches.length>1)return;if(dragged==0){var dy=(mouseY-offsetY)*12.34/width;voltage=voltage0-(dy);voltage=constrain(voltage,1,5);return false}if(dragged==1){var dx=(mouseX-offsetX)*36/width;resist=resist0+dx;resist=constrain(resist,1,5);return false}}function touchEnded(){dragged=-1}